---
title: Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹HTMLè¦ç´ ã®ç¨®é¡ã‚’å¤‰æ›´å¯èƒ½ã«ã™ã‚‹ãŸã‚ã®ãƒ‘ã‚¿ãƒ¼ãƒ³
publishDate: "2023-06-04T12:35:00.000+09:00"
---

Reactã®UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã„ã‚‹ã¨ã€ã‚ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã‚ˆã£ã¦ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹HTMLè¦ç´ ã®ç¨®é¡ã‚’å¤‰æ›´ã—ãŸããªã‚‹å ´é¢ãŒã‚ã‚‹ã€‚ãŸã¨ãˆã°ã€é€šå¸¸ã¯`button`è¦ç´ ã¨ã—ã¦ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹`Button`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ã†ã¨ãã«ã€ä»£ã‚ã‚Šã«`a`è¦ç´ ã‚’ä½¿ã£ã¦ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ãŸã„ã¨ã„ã†ã‚±ãƒ¼ã‚¹ã€‚

## `as` prop

ãã®ã‚ˆã†ãªå ´åˆã€ä¸€èˆ¬çš„ã«ã¯ã€Buttonã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«`as` propã‚’å®Ÿè£…ã—ã¦å¯¾å‡¦ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚

```jsx
function Button({ as: Component = "button", ...props }) {
	return <Component {...props} />;
}

render(
	<>
		<Button type="button">
			Iâ€™m a <code>button</code> element
		</Button>
		<Button as="a" href="/">
			Iâ€™m an <code>a</code> element
		</Button>
	</>,
);
```

ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€Polymorphicã¨ã‚‚å‘¼ã°ã‚Œã‚‹ã€‚[styled-components](https://styled-components.com/docs/api#as-polymorphic-prop)ã‚„[Material UI](https://mui.com/material-ui/guides/composition/#component-prop)ã€[Chakra UI](https://chakra-ui.com/docs/styled-system/style-props#the-as-prop)ãªã©ã€æ•°å¤šãã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§åŒç­‰ã®æ‰‹æ³•ãŒæ¡ç”¨ã•ã‚Œã¦ã„ã‚‹ã€‚

ã“ã®ã‚³ãƒ¼ãƒ‰ã ã‘ã‚’è¦‹ã‚Œã°ã”ãã”ãç°¡å˜ã«å®Ÿç¾ã§ãã‚‹æ©Ÿèƒ½ã®ã‚ˆã†ã«æ€ãˆã‚‹ãŒã€TypeScriptã¨ã—ã¦æ­£ã—ãå‹ä»˜ã‘ã‚’ã—ã‚ˆã†ã—ãŸã‚Šã€[`forwardRef`](https://react.dev/reference/react/forwardRef)ã‚’é©ç”¨ã—ãŸã‚Šã—ã¦ã„ã‚‹ã¨ã€ãã“ãã“è¤‡é›‘ãªå®Ÿè£…ã«ãªã£ã¦ã—ã¾ã†ã€‚

å…·ä½“çš„ãªå®Ÿè£…æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€[è©³ã—ãè§£èª¬ã—ã¦ã„ã‚‹è¨˜äº‹](https://blog.logrocket.com/build-strongly-typed-polymorphic-components-react-typescript/ "Build strongly typed polymorphic components with React and TypeScript")ãŒã‚ã£ãŸã®ã§ãã¡ã‚‰ã«è­²ã‚‹ã€‚

ãŸã ã€å˜ã«ãã®ä»•çµ„ã¿ã®å®Ÿè£…ãŒè¤‡é›‘ã«ãªã‚‹ã ã‘ã§ã‚ã‚Œã°ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ã¦ãŠã„ãŸã‚‚ã®ã‚’å‚ç…§ã—ã¦ä½¿ãˆã°ã‚ˆã„ã€‚å®Ÿéš›ã«ãã‚Œã«å½“ãŸã‚‹npmãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚‚ã„ãã¤ã‹ã‚ã‚‹ã€‚

- [@radix-ui/react-polymorphic](https://www.radix-ui.com/docs/primitives/utilities/polymorphic)
- [react-polymorphic-types](https://github.com/kripod/react-polymorphic-types)

ã—ã‹ã—ã€ãã‚Œä»¥å¤–ã«ã‚‚ã„ãã¤ã‹ã®å•é¡ŒãŒã‚ã‚‹ã€‚ã‹ã¤ã¦`as` propã‚’æ¡ç”¨ã—ã¦ã„ãŸ[Radix UI](https://www.radix-ui.com/)ã§ã¯ã€ã“ã‚Œã‚‰ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€`as` propãŒå»ƒæ­¢ã•ã‚Œã¦æ–°ãŸã«`asChild` propãŒæ¡ç”¨ã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ãŸ[Jenna Smith](https://github.com/jjenzz)æ°ã«ã‚ˆã‚‹ã¨ã€ã„ãã¤ã‹ã®è¦³ç‚¹ã‹ã‚‰è¦‹ã¦ã€`as` propã¯éåº¦ãªè¤‡é›‘æ€§ã‚’ã‚‚ãŸã‚‰ã™ã¨è¨€ã†ã€‚

<blockquote class="twitter-tweet">
	<p lang="en" dir="ltr">
		I&#39;ve been thinking a lot about the `as` prop for polymorphism lately and wondering why we
		all went down the road of runtime TypeScript polymorphism. It introduces so many unnecessary
		complexities, bloats error messages and kills TS perf... ğŸ§µ
	</p>
	&mdash; jenna (@jjenzz){" "}
	<a href="https://twitter.com/jjenzz/status/1423766700885954562?ref_src=twsrc%5Etfw">
		August 6, 2021
	</a>
</blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

ä¸€ã¤ã¯ã€TypeScriptã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¤‡é›‘ã«ãªã£ã¦ã—ã¾ã†ã“ã¨ã€‚ãŸã¨ãˆã°ã€Reactã®è¦ç´ ã«é–“é•ã£ãŸpropãŒæ¸¡ã•ã‚ŒãŸã¨ãã€é€šå¸¸ã®`a`è¦ç´ ã¨ã€`as` propã¨ã—ã¦aè¦ç´ ãŒæŒ‡å®šã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ¯”è¼ƒã™ã‚‹ã¨ã€æ˜ã‚‰ã‹ã«å¾Œè€…ã®æ–¹ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦ç†è§£ã—ã¥ã‚‰ã„ã€‚

<figure>![](./assets/2023-06-03-react-changeable-element-type-patterns/as-prop-error.png)</figure>

æ¬¡ã«ã€TypeScriptã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ‚ªåŒ–ã•ã›ã‚‹ã“ã¨ã€‚`as` propã®å‹å®šç¾©ã«ãŠã„ã¦ã¯ã€é«˜åº¦ãªå‹æ¨è«–ã‚„æ¡ä»¶å‹ã€ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’å¤šç”¨ã™ã‚‹ã“ã¨ã«ãªã‚Šã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ãŸã‚ã®è² è·ãŒé«˜ã¾ã£ã¦ã—ã¾ã†ã€‚

ãã—ã¦ã€`as` propã‚’ä½¿ã†ã¨ã€å…ƒã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨`as`ã«å½“ãŸã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®åŒæ–¹ã«å¯¾ã™ã‚‹propã‚’åŒæ™‚ã«è¨˜è¿°ã™ã‚‹ã“ã¨ã«ãªã‚Šã€ã©ã®propãŒã©ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãŸã‚ã®ã‚‚ã®ã‹ãŒç†è§£ã—ã¥ã‚‰ããªã‚‹ã€‚ã•ã‚‰ã«ã€å…ƒã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨`as`ã«å½“ãŸã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«åŒã˜åå‰ã®propãŒã‚ã‚‹ã¨ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã—ã¦ã—ã¾ã†ã€‚

<figure>
```jsx
const ComponentOwnProps = {
	onChange(thing: boolean): void;
};

const Component = () => {/* ... */};

// thing would be `event` type from `input`
return <Component as="input" onChange={thing => console.log(thing)} />;

````

<figcaption>
[\[Polymorphic\] Allow `ComponentType` props to override by jjenzz Â· Pull Request #779 Â· radix-ui/primitives](https://github.com/radix-ui/primitives/pull/779#issuecomment-879257075)
</figcaption>
</figure>

## `asChild` prop

ã“ã‚Œã‚‰ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€æ–°ãŸã«`asChild` propãŒè€ƒæ¡ˆã•ã‚ŒãŸã€‚æ¬¡ã®ã‚ˆã†ã«ã—ã¦ä½¿ç”¨ã™ã‚‹ã€‚

<figure>
```jsx
import * as React from 'react';
import * as Tooltip from '@radix-ui/react-tooltip';

export default () => (
	<Tooltip.Root>
		<Tooltip.Trigger asChild>
			<a href="https://www.radix-ui.com/">Radix UI</a>
		</Tooltip.Trigger>
		<Tooltip.Portal>â€¦</Tooltip.Portal>
	</Tooltip.Root>
);
````

<figcaption>
[Composition â€“ Radix UI](https://www.radix-ui.com/docs/primitives/guides/composition)
</figcaption>
</figure>

ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹è¦ç´ ã‚’å¤‰æ›´ã™ã‚‹å¯¾è±¡ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å¯¾ã—ã¦ã€`as` propã®ä»£ã‚ã‚Šã«`asChild` propã‚’ä»˜ä¸ã™ã‚‹ã€‚ãã®`children` propã¨ã—ã¦ä»»æ„ã®ãƒãƒ¼ãƒ‰ã‚’æŒ‡å®šã™ã‚‹ã€‚

ã“ã®`asChild` propã«ã‚ˆã£ã¦ã€å‰è¿°ã®å•é¡Œã¯ä¸€é€šã‚Šè§£æ±ºã•ã‚Œã‚‹ã“ã¨ã«ãªã‚‹ã€‚

ãŠã¾ã‘ã«ã€`asChild` propã®ç‰¹æ€§ã¨ã—ã¦ã‚‚ãŸã‚‰ã•ã‚Œã‚‹ã®ãŒã€`asChild` propã‚’æŒ‡å®šã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¤‡æ•°ã«å…¥ã‚Œå­ã«ã§ãã‚‹æ©Ÿèƒ½ã§ã‚ã‚‹ã€‚æ¬¡ã®ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹ã“ã¨ã§ã€è¦ªã«å½“ãŸã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ©Ÿèƒ½ã‚’ç¶™æ‰¿ã—ã¦ã„ãã“ã¨ãŒã§ãã‚‹ã€‚

<figure>
```jsx
import * as React from 'react';
import * as Dialog from '@radix-ui/react-dialog';
import * as Tooltip from '@radix-ui/react-tooltip';

const MyButton = React.forwardRef((props, forwardedRef) => (
<button {...props} ref={forwardedRef} />
));

export default () => {
	return (
		<Dialog.Root>
			<Tooltip.Root>
				<Tooltip.Trigger asChild>
					<Dialog.Trigger asChild>
						<MyButton>Open dialog</MyButton>
					</Dialog.Trigger>
				</Tooltip.Trigger>
				<Tooltip.Portal>â€¦</Tooltip.Portal>
			</Tooltip.Root>

    		<Dialog.Portal>...</Dialog.Portal>
    	</Dialog.Root>
    );

};

````

<figcaption>
[Composition â€“ Radix UI](https://www.radix-ui.com/docs/primitives/guides/composition#composing-multiple-primitives)
</figcaption>
</figure>

### è‡ªå‰ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«`asChild` propã‚’çµ„ã¿è¾¼ã‚€

`asChild` propã¯Radix UIã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§æä¾›ã•ã‚Œã¦ã„ã‚‹æ©Ÿèƒ½ã ãŒã€è‡ªå‰ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã‚‚å®¹æ˜“ã«å®Ÿè£…ã§ãã‚‹ã€‚[`@radix-ui/react-slot`](https://www.radix-ui.com/docs/primitives/utilities/slot)ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ã®ãŒã‚ˆã„ã€‚

<figure>
```jsx
import React from 'react';
import { Slot } from '@radix-ui/react-slot';

function Button({ asChild, ...props }) {
  const Comp = asChild ? Slot : 'button';
  return <Comp {...props} />;
}
````

<figcaption>
[Slot â€“ Radix UI](https://www.radix-ui.com/docs/primitives/utilities/slot)
</figcaption>
</figure>

TypeScriptã‚’ä½¿ç”¨ã—ã¤ã¤ã€`forwardRef`ã‚’é©ç”¨ã™ã‚‹å ´åˆã¯ã€æ¬¡ã®ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹ã€‚

```tsx
import { type ComponentPropsWithRef, forwardRef } from "react";

const Button = forwardRef<unknown, ComponentPropsWithRef<"button"> & { asChild?: boolean }>(
	({ asChild, ...props }, forwardedRef) => {
		const Comp: any = asChild ? Slot : "button";
		return <Comp {...props} ref={forwardedRef} />;
	},
);

Button.displayName = "Button";
```

ãŸã ã—ã€ã“ã†ãªã£ã¦ãã‚‹ã¨å®šå‹ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦ã¯ã‚„ã‚„ç…©é›‘ã§ã‚ã‚‹ã€‚ãã“ã§ä»£ã‚ã‚Šã«ã€Radix UIã®å†…éƒ¨ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹[`@radix-ui/react-primitive`](https://github.com/radix-ui/primitives/tree/main/packages/react/primitive)ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†ã“ã¨ã§å¤šå°‘ãƒã‚·ã«ãªã‚‹ã€‚

```tsx
import { Primitive } from "@radix-ui/react-primitive";
import type * as Radix from "@radix-ui/react-primitive";
import { forwardRef } from "react";

type ButtonElement = React.ElementRef<typeof Primitive.button>;
type PrimitiveButtonProps = Radix.ComponentPropsWithoutRef<typeof Primitive.button>;
interface ButtonProps extends PrimitiveButtonProps {}

const Button = forwardRef<ButtonElement, ButtonProps>((props, forwardedRef) => (
	<Primitive.button {...props} ref={forwardedRef} />
));

Button.displayName = "Button";
```

ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½¿ç”¨æ–¹æ³•ã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã•ã‚Œã¦ã„ãªã„ã®ã§ã€[Radix UIã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ä¸­ã§å®Ÿéš›ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹æ§˜å­](https://github.com/radix-ui/primitives/tree/1d57ea78007733facfa2ac7fc0cd919a545b39f6/packages/react)ã‚’å‚è€ƒã«ã—ã¦å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒå£«ã®propsã®ãƒãƒ¼ã‚¸

`Slot`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆãŠã‚ˆã³`Primitive.*`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰ã®propsã¯ã€ãã®å­ã®propsã¨ãƒãƒ¼ã‚¸ã•ã‚Œã‚‹ä»•çµ„ã¿ã«ãªã£ã¦ã„ã‚‹ã€‚ãŸã¨ãˆã°ã€æ¬¡ã®ã‚ˆã†ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã¨ã™ã‚‹ã€‚

```tsx
import { Primitive } from "@radix-ui/react-primitive";
import type * as Radix from "@radix-ui/react-primitive";
import { forwardRef } from "react";

type ButtonElement = React.ElementRef<typeof Primitive.button>;
type PrimitiveButtonProps = Radix.ComponentPropsWithoutRef<typeof Primitive.button>;
interface ButtonProps extends PrimitiveButtonProps {}

const Button = forwardRef<ButtonElement, ButtonProps>((props, forwardedRef) => (
	<Primitive.button
		{...props}
		ref={forwardedRef}
		className="Button"
		style={{ backgroundColor: "gray" }}
		data-test="original"
		onClick={(_event) => console.log("original event")}
	/>
));

Button.displayName = "Button";

render(
	<Button asChild>
		<a
			href="/"
			className="child"
			style={{ border: "1px solid" }}
			data-test="child"
			onClick={(_event) => console.log("child event")}
		>
			Hello
		</a>
	</Button>,
);
```

ã“ã®`Button`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®propsã¯ã€æ“¬ä¼¼çš„ã«è¡¨ç¾ã™ã‚Œã°ã€æ¬¡ã®ã‚ˆã†ã«ãƒãƒ¼ã‚¸ã•ã‚Œã‚‹ã“ã¨ã«ãªã‚‹ã€‚

```tsx
<a
	href="/"
	data-test="child"
	class="Button child"
	style={{
		backgroundColor: "gray",
		border: "1px solid",
	}}
	onClick={(...args) => {
		childProps.onClick(...args);
		slotProps.onClick(...args);
	}}
>
	Hello
</a>
```

ã“ã®propsã®ãƒãƒ¼ã‚¸ã«ã¯æ¬¡ã®ãƒ«ãƒ¼ãƒ«ãŒã‚ã‚‹ã€‚

- `on`ã‹ã‚‰å§‹ã¾ã‚‹åŒåã®propãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚Œã°ã€ãã‚Œã‚‰ã‚’composeã™ã‚‹é–¢æ•°ãŒä½œæˆã•ã‚Œã‚‹
- `style` propã®å€¤ã¯ãƒãƒ¼ã‚¸ã•ã‚Œã‚‹ã€‚åŒã˜ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚Œã°å­ãŒå„ªå…ˆã•ã‚Œã‚‹
- `className` propã®å€¤ã¯ãƒãƒ¼ã‚¸ã•ã‚Œã‚‹
- ãã‚Œä»¥å¤–ã®propã¯å­ã®å€¤ã§ä¸Šæ›¸ãã•ã‚Œã‚‹

è©³ã—ãã¯ã€[`mergeProps`](https://github.com/radix-ui/primitives/blob/1d57ea78007733facfa2ac7fc0cd919a545b39f6/packages/react/slot/src/Slot.tsx#L91-L122)ã®å®Ÿè£…ã‚’å‚ç…§ã®ã“ã¨ã€‚

ä»¥ä¸Šã®ã‚ˆã†ã«ã€`Slot`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®propsã¯ãã®å­ã®propsã¨è‡ªå‹•çš„ã«ãƒãƒ¼ã‚¸ã•ã‚Œã‚‹ä»•çµ„ã¿ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã¯æŠŠæ¡ã—ã¦ãŠããŸã„ã€‚

æ³¨æ„ã™ã¹ãã¯ã€`Button`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®propsã«ã¤ã„ã¦ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å´ã§ãƒãƒ¼ã‚¸ã™ã‚‹å®Ÿè£…ã‚’è¡Œã‚ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†ã“ã¨ã€‚ã‚‚ã—æ¬¡ã®ã‚ˆã†ã«ã€`Button`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®propsã®ãƒãƒ¼ã‚¸ã‚’è€ƒæ…®ã—ãªã„å®Ÿè£…ã«ãªã£ã¦ã„ã‚‹ã¨ã€`Button`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«propsã‚’æŒ‡å®šã—ãŸéš›ã«æœŸå¾…ã«åã™ã‚‹æŒ™å‹•ã‚’ã™ã‚‹ã€‚

```tsx
import { Primitive } from "@radix-ui/react-primitive";
import type * as Radix from "@radix-ui/react-primitive";
import { forwardRef } from "react";

type ButtonElement = React.ElementRef<typeof Primitive.button>;
type PrimitiveButtonProps = Radix.ComponentPropsWithoutRef<typeof Primitive.button>;
interface ButtonProps extends PrimitiveButtonProps {}

const Button = forwardRef<ButtonElement, ButtonProps>((props, forwardedRef) => (
	<Primitive.button
		{...props}
		ref={forwardedRef}
		className="Button"
		style={{ backgroundColor: "gray" }}
		data-test="original"
		onClick={(_event) => console.log("original event")}
	/>
));

Button.displayName = "Button";

render(
	<Button
		className="child"
		style={{ border: "1px solid" }}
		data-test="child"
		onClick={(_event) => console.log("child event")}
	>
		Hello
	</Button>,
);
```

ã“ã®`Button`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã€æ¬¡ã®ã‚ˆã†ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã€‚

```tsx
<button
	className="Button"
	data-test="original"
	style={{ backgroundColor: 'gray' }}
	onClick={_event => console.log('original event')}
>
	Hello
</Button>
```

ã“ã‚Œã§ã¯ã€æœŸå¾…é€šã‚Šä¸Šæ›¸ãã§ãã‚‹ã‚‚ã®ã¨ã€æœŸå¾…ã«åã—ã¦ä¸Šæ›¸ãã§ããªã„ã‚‚ã®ãŒã€propã®ç¨®é¡ã«ã‚ˆã£ã¦ã¾ã¡ã¾ã¡ã«ãªã£ã¦ã—ã¾ã†ã€‚æœŸå¾…é€šã‚Šã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿç¾ã™ã‚‹ã«ã¯ã€`Slot`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«propsãŒæ¸¡ã•ã‚Œã‚‹å‰ã«ã€ãã‚Œã‚‰ã®å€¤ã‚’ãƒãƒ¼ã‚¸ã—ã¦ãŠã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ãŸã¨ãˆã°ã€æ¬¡ã®ã‚ˆã†ãªå®Ÿè£…ã«ãªã‚‹ã€‚

```tsx
import { Primitive } from "@radix-ui/react-primitive";
import type * as Radix from "@radix-ui/react-primitive";
import { forwardRef } from "react";
import { mergeRefs } from "react-merge-refs";

type ButtonElement = React.ElementRef<typeof Primitive.button>;
type PrimitiveButtonProps = Radix.ComponentPropsWithoutRef<typeof Primitive.button>;
interface ButtonProps extends PrimitiveButtonProps {}

const Button = forwardRef<ButtonElement, ButtonProps>((props, forwardedRef) => {
	const internalRef = useRef(null);
	return (
		<Primitive.button
			{...props}
			ref={mergeRefs([internalRef, forwardedRef])}
			className={["Button", props.classname].filter(Boolean).join(" ")}
			style={{
				backgroundColor: "gray",
				...props.style,
			}}
			data-test={(props as any)["data-test"] || "original"}
			onClick={() => {
				props.onClick?.(event);
				console.log("original event");
			}}
		/>
	);
});

Button.displayName = "Button";
```

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä¸­ã®å­ã‚’è¦å®šã™ã‚‹å ´åˆ

å ´åˆã«ã‚ˆã£ã¦ã¯ã€`Button`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…ã¨ã—ã¦ã€ãƒ«ãƒ¼ãƒˆã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†…å´ã«åˆ¥ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å…¥ã‚Œå­ã«ã—ãŸã„ã“ã¨ã‚‚ã‚ã‚‹ã ã‚ã†ã€‚`as` propã‚’ä½¿ãˆã°ã€æ¬¡ã®ã‚ˆã†ã«å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

```jsx
function Button({ as: Component = "button", children, ...props }) {
	return (
		<Component {...props} className={["Button", props.className].filter(Boolean).join(" ")}>
			<span className="ButtonLabel">{children}</span>
		</Component>
	);
}
```

ã—ã‹ã—ã€`asChild` propã§åŒç­‰ã®ã“ã¨ã‚’å®Ÿç¾ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ã‹ãªã‚Šè¤‡é›‘ãªå®Ÿè£…ãŒå¿…è¦ã«ãªã‚‹ã€‚ãŸã¨ãˆã°æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

```tsx
import { Primitive } from "@radix-ui/react-primitive";
import type * as Radix from "@radix-ui/react-primitive";
import {
	Children,
	ElementRef,
	ReactElement,
	ReactNode,
	cloneElement,
	forwardRef,
	isValidElement,
} from "react";

type ButtonElement = ElementRef<typeof Primitive.button>;
type PrimitiveButtonProps = Radix.ComponentPropsWithoutRef<typeof Primitive.button>;
interface ButtonProps extends PrimitiveButtonProps {}

export const Button = forwardRef<ButtonElement, ButtonProps>(
	({ children, ...props }, forwardedRef) => {
		const wrapChildren = (children: ReactNode) => <span className="ButtonLabel">{children}</span>;

		return (
			<Primitive.button
				{...props}
				ref={forwardedRef}
				className={["Button", props.className].filter(Boolean).join(" ")}
			>
				{props.asChild
					? isValidElement(children)
						? cloneElement(Children.only(children as ReactElement), {
								ref: forwardedRef,
								children: wrapChildren(children.props.children),
						  })
						: children
					: wrapChildren(children)}
			</Primitive.button>
		);
	},
);
```

<details>
<summary>`Button`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹</summary>

```tsx
import { describe, expect, it } from "vitest";
import renderer from "react-test-renderer";
import { Button } from "./button";

describe("empty", () => {
	it("default", async () => {
		const tree = renderer.create(<Button></Button>).toJSON();
		expect(tree).toMatchInlineSnapshot(`
      <button
        className="Button"
      >
        <span
          className="ButtonLabel"
        />
      </button>
    `);
	});
	it("asChild", async () => {
		const tree = renderer.create(<Button asChild></Button>).toJSON();
		expect(tree).toMatchInlineSnapshot("null");
	});
});

describe("string", () => {
	it("default", async () => {
		const tree = renderer.create(<Button>string</Button>).toJSON();
		expect(tree).toMatchInlineSnapshot(`
      <button
        className="Button"
      >
        <span
          className="ButtonLabel"
        >
          string
        </span>
      </button>
    `);
	});
	it("asChild", async () => {
		const tree = renderer.create(<Button asChild>string</Button>).toJSON();
		expect(tree).toMatchInlineSnapshot("null");
	});
});

describe("single element", () => {
	it("default", async () => {
		const tree = renderer
			.create(
				<Button>
					<a href="/">single</a>
				</Button>,
			)
			.toJSON();
		expect(tree).toMatchInlineSnapshot(`
      <button
        className="Button"
      >
        <span
          className="ButtonLabel"
        >
          <a
            href="/"
          >
            single
          </a>
        </span>
      </button>
    `);
	});
	it("asChild", async () => {
		const tree = renderer
			.create(
				<Button asChild>
					<a href="/">single</a>
				</Button>,
			)
			.toJSON();
		expect(tree).toMatchInlineSnapshot(`
      <a
        className="Button"
        href="/"
      >
        <span
          className="ButtonLabel"
        >
          single
        </span>
      </a>
    `);
	});
});

describe("mixed", () => {
	it("default", async () => {
		const tree = renderer
			.create(
				<Button>
					<span>multi</span>-<a href="/">ple</a>
				</Button>,
			)
			.toJSON();
		expect(tree).toMatchInlineSnapshot(`
      <button
        className="Button"
      >
        <span
          className="ButtonLabel"
        >
          <span>
            multi
          </span>
          -
          <a
            href="/"
          >
            ple
          </a>
        </span>
      </button>
    `);
	});
	it("asChild", async () => {
		expect(() =>
			renderer.create(
				<Button asChild>
					<span>multi</span>-<a href="/">ple</a>
				</Button>,
			),
		).toThrowError();
	});
});
```

</details>

ã“ã‚Œã¯ã‚ã¾ã‚Šç¾å®Ÿçš„ãªå®Ÿè£…æ–¹é‡ã§ã¯ãªã„ã—ã€ãã‚‚ãã‚‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ã—ã¦ã‚ã¾ã‚Šç›´æ„Ÿçš„ã§ã¯ãªã„ã¨æ€ã†ã€‚

ã‚‚ã£ã¨ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªè§£æ±ºç­–ã¨ã—ã¦ã¯ã€å†…å´ã«å…¥ã‚Œå­ã«ãªã£ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦åˆ‡ã‚Šå‡ºã—ã¦ã—ã¾ã†ã“ã¨ã ã‚ã†ã€‚ãã—ã¦ã€åˆ©ç”¨æ™‚ã«ã¯ãã‚Œã‚‰äºŒã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ã¨ã„ã†è¦ç´„ã‚’è¨­ã‘ã¦ãŠãã€‚

```tsx
<Button>
	<ButtonLabel>Hello</ButtonLabel>
</Button>

<Button asChild>
	<a href="/">
		<ButtonLabel>Hello</ButtonLabel>
	</a>
</Button>
```

å®Ÿéš›ã®ã¨ã“ã‚ã€Radix UIã«ãŠã„ã¦ã¯ã“ã®ã‚ˆã†ãªè¨­è¨ˆæ–¹é‡ãŒæ¡ç”¨ã•ã‚Œã¦ã„ã‚‹ã€‚ã—ã‹ã—ã€Radix UIã®ã‚ˆã†ãªãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨é•ã£ã¦ã€ä¸€èˆ¬çš„ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ã¯ã€ã“ã‚Œã§ã¯ä½¿ã„å‹æ‰‹ãŒæ‚ªã„å ´åˆãŒã‚ã‚‹ã ã‚ã†ã€‚

## Ariakitã«ãŠã‘ã‚‹`render` prop

[Ariakit](https://ariakit.org/)ã§ã¯ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹è¦ç´ ã‚’`render` propã‚’ä»‹ã—ã¦å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã‚‹ã€‚

<figure>
```jsx
<Combobox render={<textarea rows={5} />} />
```

<figcaption>
[Composition - Ariakit](https://ariakit.org/guide/composition#changing-the-html-element)
</figcaption>
</figure>

èˆˆå‘³æ·±ã„ã®ã¯ã€ãã®`render` propã«æ¸¡ã•ã‚ŒãŸè¦ç´ ã«å¯¾ã—ã¦ã€å†…éƒ¨çš„ã«ç®¡ç†ã•ã‚ŒãŸpropsãªã©ãŒæš—é»™çš„ã«æ¸¡ã•ã‚Œã‚‹ä»•çµ„ã¿ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã€‚ãŸã¨ãˆã°ã‚ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å¯¾ã—ã¦ã€`render` propã¨`children` propã‚’åŒæ™‚ã«æŒ‡å®šã™ã‚‹ã¨ã€`render` propã«æŒ‡å®šã—ãŸè¦ç´ ã«å¯¾ã—ã¦ãã®`children` propãŒæ¸¡ã•ã‚Œã‚‹ä»•çµ„ã¿ã«ãªã£ã¦ã„ã‚‹ã€‚

<figure>
```jsx
<Tab render={<Link href="/new" />}>New</Tab>
```

<figcaption>
[Composition - Ariakit](https://ariakit.org/guide/composition#composing-with-custom-components)
</figcaption>
</figure>

ã“ã‚Œã¯æ¬¡ã®ã‚ˆã†ãªçµæœã«ãªã‚‹ã€‚

```jsx
<Link href="/new">New</Link>
```

å…ˆã»ã©ã®`asChild` propã«ãŠã„ã¦ã¯ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†…å´ã«åˆ¥ã®è¦ç´ ãŒå…¥ã‚Œå­ã«ãªã£ã¦ã„ã‚‹å ´åˆã®è¡¨ç¾ã®é›£ã—ã•ãŒå•é¡Œã«ãªã£ãŸã€‚ã—ã‹ã—ã€ã“ã®Ariakitã®`render` propã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å€Ÿç”¨ã™ã‚Œã°ã€æ¯”è¼ƒçš„ç›´æ„Ÿçš„ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ã‚·ãƒ³ãƒ—ãƒ«ãªå®Ÿè£…ã‚’å®Ÿç¾ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚

```tsx
import { ComponentProps, ReactElement, ReactNode, cloneElement, forwardRef } from "react";

type ButtonProps = { render?: ReactElement } & ComponentProps<"button">;

const Button = forwardRef<HTMLElement, ButtonProps>(
	({ render, children, ...props }, forwardedRef) => {
		const createElement = (props: any, children: ReactNode) => {
			return render ? (
				cloneElement(render, props, children)
			) : (
				<button {...props}>{children}</button>
			);
		};

		return createElement(
			{
				...props,
				ref: forwardedRef,
				className: ["Button", props.className].filter(Boolean).join(" "),
			},
			<span className="ButtonLabel">{render?.props.children || children}</span>,
		);
	},
);

render(
	<>
		<Button>Hello</Button>
		<Button render={<a href="/" />}>Hello</Button>
		<Button render={<a href="/">Hello</a>} />
	</>,
);
```

å¿…è¦ã«å¿œã˜ã¦ã€[Ariakitã®`createElement`ã®å®Ÿè£…ã‚‚å‚ç…§ã®ã“ã¨](https://github.com/ariakit/ariakit/blob/845c3b2f0ddba4bf40286743ec6c12feccb3c02f/packages/ariakit-react-core/src/utils/system.tsx#L83-L110)ã€‚

## Base UIã«ãŠã‘ã‚‹`slots` propã¨`slotProps` prop

[Base UI](https://mui.com/base/getting-started/overview/)ã§ã¯ã€[ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†…éƒ¨ã®æ§‹é€ ã¾ã§ä¸Šæ›¸ãã™ã‚‹ã“ã¨ãŒã§ãã‚‹`slots` propãŠã‚ˆã³`slotProps` propãŒæä¾›ã•ã‚Œã¦ã„ã‚‹](https://mui.com/base/guides/overriding-component-structure/)ã€‚

<figure>
```jsx
<Select slots={{ listbox: 'ol' }} defaultValue="First option">
  <Option value="First option">First option</Option>
  <Option value="Second option">Second option</Option>
</Select>
```

<figcaption>[Overriding component structure - Base UI](https://mui.com/base/guides/overriding-component-structure/#the-slots-prop)</figcaption>
</figure>

<figure>
```jsx
<Badge slotProps={{ badge: { className: 'my-badge' } }} />
```

<figcaption>[Overriding component structure - Base UI](https://mui.com/base/guides/overriding-component-structure/#the-slotprops-prop)</figcaption>
</figure>

`as` propã§ã¯ãƒ«ãƒ¼ãƒˆã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã—ã‹å¤‰æ›´ã§ããªã‹ã£ãŸã®ã«å¯¾ã—ã¦ã€Base UIã®`slots` propã§ã¯ã€ãã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†…éƒ¨ã®ã‚µãƒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¾ã§å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚`slotProps` propã‚’ä½¿ãˆã°ã€ãƒ«ãƒ¼ãƒˆãŠã‚ˆã³ã‚µãƒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®propsã‚’å¤‰æ›´ã§ãã‚‹ã€‚

`asChild` propã‚„Ariakitã®`render` propã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸè¨­è¨ˆã§ã¯ã€æä¾›ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ç´°ã‹ãåˆ†å‰²ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ãã‚Œã‚‰ã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ã“ã¨ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼å´ã®è²¬å‹™ã«ãªã‚‹ã€‚ä¸€æ–¹ã€Base UIã®`slots` propãŠã‚ˆã³`slotProps` propã‚’å‰æã¨ã™ã‚‹ã¨ã€æä¾›ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè‡ªä½“ã‚’ç´°åˆ†åŒ–ã™ã‚‹å¿…è¦ã¯ãªããªã‚‹ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒçµ„ã¿åˆã‚ã›ã¦ä½¿ã†è² è·ã¯è»½æ¸›ã•ã‚Œã‚‹ã€‚

å¼·ã„ã¦è¨€ã†ãªã‚‰ã°ã€å‰è€…ã®æ–¹ãŒæŸ”è»Ÿæ€§ãŒã‚ã£ã¦ã‚·ãƒ³ãƒ—ãƒ«ã€å¾Œè€…ã®æ–¹ãŒç°¡æ½”ã«ä½¿ãˆã¦ã‚¤ãƒ¼ã‚¸ãƒ¼ã€ã¨ã„ã†é•ã„ã ã‚ã†ã‹ã€‚ã¾ã Base UIã«ã¤ã„ã¦ã®è€ƒå¯ŸãŒååˆ†ã«ã§ãã¦ã„ãªã„ã®ã§ã€ç·æ‹¬ã¨ã—ã¦ã¯ç‰©è¶³ã‚Šãªã„ã‘ã‚Œã©ã€ã²ã¨ã¾ãšä»Šå›ã¯ã“ã‚“ãªã¨ã“ã‚ã§ã€‚
